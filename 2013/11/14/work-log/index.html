
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
   <meta http-equiv="content-type" content="text/html; charset=utf-8" />
   <title>Debugging ML Gradient (part 2) &larr; </title>
   <meta name="author" content="Kyle Simek" />

   <link rel="start" href="/ksimek/research/" />

	
	
    <link rel="shortcut icon" href="/ksimek/research/favicon.ico">

	
	

   <!-- syntax highlighting CSS -->
   <link rel="stylesheet" href="/ksimek/research/assets/themes/mark-reid/css/syntax.css" type="text/css" />

   <!-- Jquery UI CSS --!>
   <link media="screen" rel="stylesheet" href="/ksimek/research/css/ui-smoothness/jquery-ui-1.8.22.custom.css" type="text/css" />

   <!-- Homepage CSS -->
   <link media="screen" rel="stylesheet" href="/ksimek/research/assets/themes/mark-reid/css/screen.css" type="text/css" />

   <!-- Handheld CSS -->
   <link media="handheld, only screen and (max-width: 480px), only screen and (max-device-width: 480px)" href="/ksimek/research/assets/themes/mark-reid/css/handheld.css" type="text/css" rel="stylesheet" />


<!--[if IEMobile]>
<link rel="stylesheet" type="text/css" href="/ksimek/research/assets/themes/mark-reid/css/handheld.css" media="screen" />
<![endif]-->

   <!-- Mathjax Javascript -->
   <script type="text/javascript"
     src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
   </script>

   <!-- three.js Javascript -->
    <script src="/ksimek/research/js/jquery.js"></script>
    <script src="/ksimek/research/js/jquery-ui-1.8.22.custom.min.js"></script>

    

    <script type="text/javascript">
        $(document).ready(function(){
                $('#javascript_error').hide();
        });
    </script>



</head>
<body id="">
<div id="site">
  
  <div id="header">
    <h1>
    	<a href="/ksimek/research/" title="KLS Research Blog">KLS Research Blog</a>
    	<span class="byline">&larr; <a href="/ksimek/research/">Nothing to see here...</a></span>
    </h1>
    <ul class="nav">
      <li><a class="home" href="/ksimek/research/">Home</a></li>
      <li><a href="/ksimek/research/about.html">About</a></li>
      <li><a href="/ksimek/research/contact.html">Contact</a></li>
      <li><a  href="/ksimek/research/archive.html">Archive</a></li>
      <li><a  href="/ksimek/research/categories.html">Categories</a></li>
      <li><a  href="/ksimek/research/projects">Projects</a></li>
      <li><a  href="/ksimek/research/events">Events</a></li>
      <li><a  href="/ksimek/research/feeds.html"><img src="/ksimek/research/img/feed-icon.gif" /></a></li> 
      <li><a  href="/ksimek/research/pomodoro.html"><img src="/ksimek/research/img/pom.png" /></a></li> 

    </ul>
  </div>


  
<div id="page" class="article">
	
  
  
    


  <h1 class="title">
        [Work Log] Debugging ML Gradient (part 2)
    </h1>

  <div class="date emphnext">
    November 14, 2013
      
 
  </div>
    


  
    

<div class="meta-info">
<table>
    <tr>
        <th>Project</th>
        <td><a href="/ksimek/research/projects/tulips.html">Tulips</a></td>
    </tr>
    <tr>
        <th>Subproject</th>
        <td>Data Association v3</td>
    </tr>
    <tr>
        <th>Working path</th>
        <td>projects/&#8203;tulips/&#8203;trunk/&#8203;src/&#8203;matlab/&#8203;data_association_3</td>
    </tr>


</table>

    Unless otherwise noted, all filesystem paths are relative to the "Working path" named above.
</div>


<p>Resuming debugging of analytical gradient.</p>

<p>I noted yesterday that the error we observed in K' was small -- on the order of 1e-5 -- implying that it wasn't sufficient to explain the end-to-end error we're seeing.  But we should put that into context.  The delta from the numerical gradient is 1e-7, so the error in K' is around 1%, i.e. in the noticible range.</p>

<p>Also remember that running analytical grdient using the K' from the numeric algorithm showed no noticible change to resutls.  So K' probably <em>isn't</em> the issue.</p>

<hr />

<p>Today's strategy: implement a legitimate test-bed that we can run for several deltas and get all intermediate values for both numeric and analytical gradient.</p>

<hr />

<p>Implemented, examining results.</p>

<p>Okay, this is weird.  All of the partial derivatives have low error (1e-5), but the final derivative of g(x) is huge (0.1).</p>

<p>Consider the analytical expression we're using for the gradient of g(x)</p>

<pre><code>g' = -0.5 * y^\top * S^\top * V' * S * y
</code></pre>

<p>Plugging-in the numerical estimate for V' above should give something close to the numerical estimate for g'.  But they're nowhere close.</p>

<pre><code>&gt;&gt; -0.5 * y' * S' * dV_hat * S * y

ans =

   -0.1015

&gt;&gt; g_hat

ans =

    0.0522
</code></pre>

<p>Stated differently, if we propagate the error in dV_hat through the expression for g', this theoretical error in g' is far smaller than the true error in the analytical expression for g'.</p>

<p>This strongly suggests there's a problem in our expression for g', that the error is not due to approximation or precision issues.  But if g' is so wrong, why are so many elements of the gradient so close to being correct?  Recall the plot of gradients from yesterday, shown below.</p>

<p><img src="/ksimek/research/img/2013-11-13-gradient_test.png" alt="" /></p>

<p>Element 22 (the element under scrutiny in the tests above) has large error, but several other elements are nearly perfect.  This suggests that if there is a problem in our expression.</p>

<p>Is it possible there's a bug in the test logic?  Maybe we're using the wrong field for y or S?  Or maybe when we perturb x, we aren't updating all the intermediate fields?</p>

<hr />

<p><strong>Got it!</strong>  We're neglecting the change in the normalizing "constant", Z. In the usual scenario, Z is constant w.r.t. the Gaussian distribution input y, but it is most certainly a function of the values of the Sigma matrix.</p>

      <address class="signature">
        Posted by
        <a class="author" href="/ksimek/research/">Kyle Simek</a> 
      </address>
  


  
  
  <div class="prev-next">
    <a href="/ksimek/research/2013/11/15/work-log" class="next" title="Friday - iPlant Reading Group">Friday - iPlant Reading Group &rarr;</a>
  
  
    <a href="/ksimek/research/2013/11/13/work-log" class="prev" title="Debugging ML gradient">&larr; Debugging ML gradient</a>
  
  </div>
  <div class="clearer"> </div>

<div class="post-sharing">
 

</div>




  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_developer = 1;
    var disqus_shortname = 'klsresearch'; // required: replace example with your forum shortname
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>




  
</div><!-- End Page -->



  
  <div id="footer">
  	<address>
  		<span class="copyright">
  			Content by <a href="/ksimek/research/about.html">Kyle Simek</a>. Original design by 
  			<a href="http://mark.reid.name/">Mark Reid</a>
  			<br/>
  			(<a rel="licence" href="http://creativecommons.org/licenses/by-nc-sa/3.0/">Some rights reserved</a>)			
  		</span>
  		<span class="engine">
  			Powered by <a href="http://github.com/mojombo/jekyll/" title="A static, minimalist CMS">Jekyll</a>
  		</span>
  	</address>
  </div>
  
</div>

<!--[if IE 6]>
<script type="text/javascript"> 
	/*Load jQuery if not already loaded*/ if(typeof jQuery == 'undefined'){ document.write("<script type=\"text/javascript\"   src=\"http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js\"></"+"script>"); var __noconflict = true; } 
	var IE6UPDATE_OPTIONS = {
		icons_path: "http://static.ie6update.com/hosted/ie6update/images/"
	}
</script>
<script type="text/javascript" src="http://static.ie6update.com/hosted/ie6update/ie6update.js"></script>
<![endif]-->

  


  <script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-33692744-2']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>




</body>
</html>

