
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
   <meta http-equiv="content-type" content="text/html; charset=utf-8" />
   <title>Dissecting the Camera Matrix, Part 3: The Intrinsic Matrix &larr; </title>
   <meta name="author" content="Kyle Simek" />

   <link rel="start" href="/ksimek/research/" />

	
	
    <link rel="shortcut icon" href="/ksimek/research/favicon.ico">

	
	

   <!-- syntax highlighting CSS -->
   <link rel="stylesheet" href="/ksimek/research/assets/themes/mark-reid/css/syntax.css" type="text/css" />

   <!-- Jquery UI CSS --!>
   <link media="screen" rel="stylesheet" href="/ksimek/research/css/ui-smoothness/jquery-ui-1.8.22.custom.css" type="text/css" />

   <!-- Homepage CSS -->
   <link media="screen" rel="stylesheet" href="/ksimek/research/assets/themes/mark-reid/css/screen.css" type="text/css" />

   <!-- Handheld CSS -->
   <link media="handheld, only screen and (max-width: 480px), only screen and (max-device-width: 480px)" href="/ksimek/research/assets/themes/mark-reid/css/handheld.css" type="text/css" rel="stylesheet" />


<!--[if IEMobile]>
<link rel="stylesheet" type="text/css" href="/ksimek/research/assets/themes/mark-reid/css/handheld.css" media="screen" />
<![endif]-->

   <!-- Mathjax Javascript -->
   <script type="text/javascript"
     src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
   </script>

   <!-- three.js Javascript -->
    <script src="/ksimek/research/js/jquery.js"></script>
    <script src="/ksimek/research/js/jquery-ui-1.8.22.custom.min.js"></script>

    

    <script type="text/javascript">
        $(document).ready(function(){
                $('#javascript_error').hide();
        });
    </script>



</head>
<body id="">
<div id="site">
  
  <div id="header">
    <h1>
    	<a href="/ksimek/research/" title="KLS Research Blog">KLS Research Blog</a>
    	<span class="byline">&larr; <a href="/ksimek/research/">Nothing to see here...</a></span>
    </h1>
    <ul class="nav">
      <li><a class="home" href="/ksimek/research/">Home</a></li>
      <li><a href="/ksimek/research/about.html">About</a></li>
      <li><a href="/ksimek/research/contact.html">Contact</a></li>
      <li><a  href="/ksimek/research/archive.html">Archive</a></li>
      <li><a  href="/ksimek/research/feeds.html"><img src="/ksimek/research/img/feed-icon.gif" /></a></li> 

    </ul>
  </div>


  
<div id="page" class="article">
	
  
  
  <h1 class="title">Dissecting the Camera Matrix, Part 3: The Intrinsic Matrix</h1>

  <div class="date emphnext">August 13, 2013</div>
    


  
    

<div class="meta-info">
<table>
    <tr>
        <th>Project</th>
        <td><a href="/ksimek/research/projects/tulips.html">Tulips</a></td>
    </tr>
    <tr>
        <th>Subproject</th>
        <td>Data Association v2</td>
    </tr>
    <tr>
        <th>Working path</th>
        <td>projects/&#8203;tulips/&#8203;trunk/&#8203;src/&#8203;matlab/&#8203;data_association_2</td>
    </tr>


</table>

    Unless otherwise noted, all filesystem paths are relative to the "Working path" named above.
</div>


<p>Earlier we studied the extrinsic camera matrix, and examined three different interpretations of its parameters.  Today I'll demonstrate two equivalent interpretations of the camera matrix.  First, we'll see how the camera parameters correspond the geometry of real physical camera.  Then I'll show how each of the intrinsic parameters corresponds to a simple 2D transform.  Finally,  give a 3D demo illustrating both interpretations</p>

<p>This is an entry in the series "Camera matrix, an interactive tour."  To read the other entries in the series, see the table of contents, here. (TODO)</p>

<p>The intrinsic matrix is:</p>

<pre><code>** EQUATION HERE **
</code></pre>

<p>We usually interpret the intrinsic matrix as a transformation from 3D non-homogeneous camera coordinates to 2D homogeneous image coordinates by projecting onto the image plane.  I call this the "camera-centric" interpretation of the intrinsic matrix, where each of the parameters represents a physical aspect of our pinhole camera's geometry:</p>

<ul>
<li><strong>Focal length</strong>: \(f_x\), \(f_y\) - The distance between the pinhole and the image plane (in pixels; all intrinsic values are measured in pixels -- more on this later).</li>
<li><strong>Principal Point Offset</strong>: \(x_0\), \(y_0\) - The position of pinhole's projection onto the camera's film, relative to the film's origin.  This projection is called the "principal point", and the line from the principal point through the pinhole is called the "principal axis".  Increasing \(x_0\) by 10 shifts the pinhole right by 10 pixels, or equivalently, shifts the film left by 10 pixels.</li>
<li><strong>Axis skew</strong>: \(s\) - As far as I know, there isn't any analogue for this in a traditional camera, but <a href="http://www.epixea.com/research/multi-view-coding-thesisse8.html#x13-320002.2.1">apparently some digitization processes can cause nonzero skew</a>.</li>
</ul>


<p>At first glance, it seems like these 5 parameters couldn't completely describe the pinhole camera.  The focal length and principal point offset amount to simple translations of the film in space.  There must be other ways to transform the film relative to the pinhole, for example, rotation or scaling, right?  Lets address these one-by-one.</p>

<p>First we'll consider rotations of the film around the principal axis.  This is traightforward:  this is handled in the extrinsic matrix's rotation parameters (as the "roll" parameter if you're using a pitch-yaw-roll formulation).</p>

<p>What about other rotations that cause the film to be non-perpendicular to the pinhole?  This question is a bit ill-posed, because it assumes the pinhole has an orientation.  In truth, the pinhole in our camera model doesn't care what "direction" the camera is pointing -- light passes through it in all directions.  The orientation of the camera is defined by the film's orientation, which (again) is handled in the extrinsic camera matrix.  If the film is rotated around a point not lying on the prinpical axis, it will also result in changes to the focal length and principal point, too.</p>

<p>What if the film doubles in size, but stays in the same position?  This scenario changes the clipping bounds of the image, which isn't actually modelled by the intrinsic matrix.  In graphics systems like OpenGL, this is modelled by adding an extra orthographic projection after the intrinsic matrix is applied, which maps image coordinates to Normalized Device Coordinates.  This is described in more detail in my post on <a href="/ksimek/research/2013/06/03/calibrated_cameras_in_opengl/">calibrated cameras in OpenGL</a>.</p>

<p>Why are values measured in pixels?</p>

<p>Imagine doubling all the physical dimensions of your pinhole camera: the film size and the focal length.  The resulting image would be unchanged (assuming the film's resolution remains constant).  The intrinsic matrix is only concerned with how points in 3d space are projected into pixel coordinates, and thus, it only represents relative dimensions.  The transformation is invariant to scaling of the camera dimensions; by representing dimensions in pixel units, we naturally capture this invariance.</p>

<p>If you know the size of your film (or digital sensor) in world units, you can convert focal length from pixels to world units.  If \(w\) is the width of the image in pixels, \(W\) is the width in world units, and the focal length in pixels is \(f_x\), you can use similar triangles to find the focal length in world units \(F_x\):</p>

<div> F_x = f_x * \frac{W_x}{w_x} </div>


<p>Other parameters \(f_x\), \(x_0\), and \(y_0\) can be found in a similar way.</p>

<p>Intrinsic parameters as 2D transformations</p>

<p>If we instead interpret our 3-vectors not as 3D image coordinates but as 2D homogeneous coordinates, we can come to an alternative interpretation of the intrinsic matrix: as a sequence of 2D affine transformations.  We can decompose the intrinsic matrix into the product of a scaling, translation, and shear amtrix, corresponding to focal length, principal point offset, and axis skew, respectively:</p>

<pre><code>TODO: equation here
</code></pre>

<p>This interpretation implies that the intrinsic camera transformation occurs <em>post-projection</em>.  One notable result of this is that intrinsic parameters cannot affect visiblity -- occluded objects cannot be revealed by simple 2D transformations in image space.</p>

<p>Full decomposition</p>

<p>We can now combine our decomposed intrinsic matrix with the extrinsic matrix decomposition we studied last time.  The result shows the sequence of five affine transformations that make up the complete camera matrix: (1) 3D rotation, (2) 3D translation, (3) 2D scaling, (4) 2D translation, and finally (5) 2D shear.</p>

<p>TODO EQUATION HERE</p>

<p>Demo</p>

<p>The demo below illustrates both interpretations of the intrinsic matrix.  The left pane represents the "camera-geometry" interpretation.  The yellow plane indicates the "virtual" image plane, but for all intents and purposes, represents the "film" of the pinhole camera.  Notice how the pinhole move relative to the image plane as \(x_0\) and \(y_0\) are adjusted.</p>

<p>The right pane represents the "2D transformation" interpretation.  Notice how changing focal length results in scaling of the projected image, and principal point results in pure translation.  Also note that since translation occurs <em>after</em> scaling, larger focal lengths will result in larger translations as \(x_0\) and \(y_0\) are adjusted.</p>

<pre><code>TODO: demo here
</code></pre>

      <address class="signature">
        Posted by
        <a class="author" href="/ksimek/research/">Kyle Simek</a> 
      </address>
  


  
  
  <div class="prev-next">
    <a href="/ksimek/research/2013/08/13/work-log" class="next" title="Work Log - Theoretical Rate variance bug; Training background curve model">Work Log - Theoretical Rate variance bug; Training background curve model &rarr;</a>
  
  
    <a href="/ksimek/research/2013/08/11/work-log" class="prev" title="Work Log - Re-run training, Re-reconstruction, Curve-Flipping">&larr; Work Log - Re-run training, Re-reconstruction, Curve-Flipping</a>
  
  </div>
  <div class="clearer"> </div>

<div class="post-sharing">
 

  
  		<div id="fb-root"></div>

<div class="post-share ulno mob">

<!-- Hacker News -->
<span class="hn"><span id="hnews"></span></span>

<!-- Twitter -->
<span class="tw"><a href="https://twitter.com/share" class="twitter-share-button" data-text="Dissecting the Camera Matrix, Part 3: The Intrinsic Matrix" data-via="" data-related="" data-count="" data-size="">Tweet</a></span>

<!-- Google+ -->
<span class="gp"><div class="g-plusone" data-size="medium" data-annotation="bubble" data-width=""></div></span>

<!-- Facebook -->
<!--
<span class="fb"><div class="fb-like" data-send="false" data-layout="button_count" data-width="90" data-show-faces="false" data-font=""></div></span>
-->

<!-- Reddit -->
<script type="text/javascript" src="http://www.reddit.com/static/button/button1.js"></script>
</div>

<script>
  
(function(doc, script) {
 	
	//Async Social Buttons
    var js, 
        fjs = doc.getElementsByTagName(script)[0],
        add = function(url, id) {
            if (doc.getElementById(id)) {return;}
            js = doc.createElement(script);
            js.src = url;
            id && (js.id = id);
            fjs.parentNode.insertBefore(js, fjs);
        };
    
    // Twitter SDK
    add('//platform.twitter.com/widgets.js', 'twitter-wjs');

    // Google+ button
    add('https://apis.google.com/js/plusone.js');
    
    // Facebook SDK
    add('//connect.facebook.net/en_GB/all.js#xfbml=1&appId=123', 'facebook-jssdk');
    
    //Hacker News Button 	
 	var hn_like = document.createElement('iframe');
      hn_like.frameborder="no";
      hn_like.scrolling="no";
      hn_like.height="28px";
      hn_like.width="110px";
      hn_like.style="border:0px;";
      hn_like.src = "http://hnlike.com/upvote.php?link="
                    + encodeURIComponent(document.location)
                    + "&title="
                    + encodeURIComponent("Dissecting the Camera Matrix, Part 3: The Intrinsic Matrix");
      hn_like.innerHTML="iframes not supported by your browser";
      
      var where = document.getElementById("hnews");
      where.parentNode.insertBefore(
        hn_like,
        where
      );
}(document, 'script'));

</script>

  



</div>




  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_developer = 1;
    var disqus_shortname = 'klsresearch'; // required: replace example with your forum shortname
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>




  
</div><!-- End Page -->



  
  <div id="footer">
  	<address>
  		<span class="copyright">
  			Content by <a href="/ksimek/research/about.html">Kyle Simek</a>. Original design by 
  			<a href="http://mark.reid.name/">Mark Reid</a>
  			<br/>
  			(<a rel="licence" href="http://creativecommons.org/licenses/by-nc-sa/3.0/">Some rights reserved</a>)			
  		</span>
  		<span class="engine">
  			Powered by <a href="http://github.com/mojombo/jekyll/" title="A static, minimalist CMS">Jekyll</a>
  		</span>
  	</address>
  </div>
  
</div>

<!--[if IE 6]>
<script type="text/javascript"> 
	/*Load jQuery if not already loaded*/ if(typeof jQuery == 'undefined'){ document.write("<script type=\"text/javascript\"   src=\"http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js\"></"+"script>"); var __noconflict = true; } 
	var IE6UPDATE_OPTIONS = {
		icons_path: "http://static.ie6update.com/hosted/ie6update/images/"
	}
</script>
<script type="text/javascript" src="http://static.ie6update.com/hosted/ie6update/ie6update.js"></script>
<![endif]-->

  


  <script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-33692744-2']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>




</body>
</html>

